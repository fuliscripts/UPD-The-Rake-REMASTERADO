-- The Rake: Remastered - Script Mejorado Fuli

-- Servicios
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")
local CoreGui = game:GetService("CoreGui")
local Lighting = game:GetService("Lighting")
local UserInputService = game:GetService("UserInputService")

-- Variables
local Rake = nil
local Speed = 50
local DomeEnabled = false
local AuraEnabled = false
local ESPEnabled = false
local FlyEnabled = false
local AntiRakeEnabled = false
local StickAuraEnabled = false
local InvisEnabled = false

-- GUI
local ScreenGui = Instance.new("ScreenGui", CoreGui)
ScreenGui.Name = "FuliHubGUI"
local Frame = Instance.new("Frame", ScreenGui)
Frame.Size = UDim2.new(0, 240, 0, 400)
Frame.Position = UDim2.new(0.05, 0, 0.2, 0)
Frame.BackgroundColor3 = Color3.new(0.1, 0.1, 0.1)
Frame.Active = true
Frame.Draggable = true

local function CreateButton(name, pos, callback)
    local Button = Instance.new("TextButton", Frame)
    Button.Size = UDim2.new(0, 220, 0, 30)
    Button.Position = UDim2.new(0, 10, 0, pos)
    Button.Text = name
    Button.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    Button.TextColor3 = Color3.new(1, 1, 1)
    Button.TextScaled = true
    Button.MouseButton1Click:Connect(callback)
end

-- Fullbright y Estamina infinita
RunService.RenderStepped:Connect(function()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Stamina") then
        LocalPlayer.Character.Stamina.Value = 100
    end
    Lighting.Brightness = 3
    Lighting.FogEnd = 100000
    Lighting.Ambient = Color3.new(1,1,1)
    Lighting.OutdoorAmbient = Color3.new(1,1,1)
end)
-- Velocidad modificada
RunService.RenderStepped:Connect(function()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        LocalPlayer.Character.Humanoid.WalkSpeed = Speed
    end
end)

-- Aura contra el Rake
local function StartAura()
    AuraEnabled = true
    while AuraEnabled do
        for _, v in pairs(Workspace:GetDescendants()) do
            if v.Name == "Rake" and v:FindFirstChild("Humanoid") then
                local distance = (v.PrimaryPart.Position - LocalPlayer.Character.PrimaryPart.Position).Magnitude
                if distance < 15 then
                    v.Humanoid:TakeDamage(10)
                end
            end
        end
        wait(0.1)
    end
end

local function StopAura()
    AuraEnabled = false
end

-- ESP para jugadores
local function StartESP()
    ESPEnabled = true
    while ESPEnabled do
        for _, v in pairs(Players:GetPlayers()) do
            if v ~= LocalPlayer and v.Character and not v.Character:FindFirstChild("ESP") then
                local Billboard = Instance.new("BillboardGui", v.Character)
                Billboard.Name = "ESP"
                Billboard.Size = UDim2.new(0, 100, 0, 40)
                Billboard.Adornee = v.Character.PrimaryPart
                Billboard.AlwaysOnTop = true

                local Label = Instance.new("TextLabel", Billboard)
                Label.Size = UDim2.new(1, 0, 1, 0)
                Label.TextColor3 = Color3.new(1, 0, 0)
                Label.BackgroundTransparency = 1
                Label.TextScaled = true
                spawn(function()
                    while ESPEnabled and Billboard.Parent do
                        Label.Text = v.Name .. " | " .. math.floor((v.Character.PrimaryPart.Position - LocalPlayer.Character.PrimaryPart.Position).Magnitude) .. "m"
                        wait(0.1)
                    end
                    Billboard:Destroy()
                end)
            end
        end
        wait(0.5)
    end
end

local function StopESP()
    ESPEnabled = false
    for _, v in pairs(Players:GetPlayers()) do
        if v.Character and v.Character:FindFirstChild("ESP") then
            v.Character.ESP:Destroy()
        end
    end
end
-- Función: Stun Stick Aura
local function StartStickAura()
    StickAuraEnabled = true
    while StickAuraEnabled do
        local tool = LocalPlayer.Character:FindFirstChild("StunStick") or LocalPlayer.Backpack:FindFirstChild("StunStick")
        if tool and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            for _, v in pairs(Workspace:GetDescendants()) do
                if v.Name == "Rake" and v:FindFirstChild("Humanoid") and v:FindFirstChild("HumanoidRootPart") then
                    local dist = (v.HumanoidRootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                    if dist < 15 then
                        tool:Activate()
                    end
                end
            end
        end
        wait(0.2)
    end
end

local function StopStickAura()
    StickAuraEnabled = false
end

-- Función: Fly
local function ToggleFly()
    FlyEnabled = not FlyEnabled
    local bodyGyro = Instance.new("BodyGyro")
    local bodyVelocity = Instance.new("BodyVelocity")
    local char = LocalPlayer.Character
    local root = char:WaitForChild("HumanoidRootPart")
    bodyGyro.P = 9e4
    bodyGyro.maxTorque = Vector3.new(9e9, 9e9, 9e9)
    bodyGyro.cframe = root.CFrame
    bodyGyro.Parent = root
    bodyVelocity.velocity = Vector3.new(0,0,0)
    bodyVelocity.maxForce = Vector3.new(9e9, 9e9, 9e9)
    bodyVelocity.Parent = root

    RunService.RenderStepped:Connect(function()
        if FlyEnabled then
            local direction = Vector3.new()
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then
                direction = direction + root.CFrame.LookVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then
                direction = direction - root.CFrame.LookVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then
                direction = direction - root.CFrame.RightVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then
                direction = direction + root.CFrame.RightVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                direction = direction + root.CFrame.UpVector
            end
            bodyVelocity.velocity = direction * Speed
        else
            bodyGyro:Destroy()
            bodyVelocity:Destroy()
        end
    end)
end

-- Función: Unlock Chat
pcall(function()
    game.StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.Chat, true)
end)
-- Función: Auto-fix Power si llevas la caja
local function AutoFixPower()
    spawn(function()
        while true do
            local char = LocalPlayer.Character
            if char and char:FindFirstChild("Toolbox") then
                for _, v in pairs(Workspace:GetDescendants()) do
                    if v.Name == "FixPrompt" and v:IsA("ProximityPrompt") then
                        fireproximityprompt(v)
                    end
                end
            end
            wait(1)
        end
    end)
end

-- Función: Dupe Scraps (agrega múltiples veces al inventario visual)
local function DupeScraps()
    for _, v in pairs(Workspace:GetDescendants()) do
        if v.Name == "Scrap" and v:IsA("Tool") then
            v:Clone().Parent = LocalPlayer.Backpack
        end
    end
end

-- Función: Anti-Rake (teleport si el Rake está muy cerca)
local function StartAntiRake()
    AntiRakeEnabled = true
    while AntiRakeEnabled do
        for _, v in pairs(Workspace:GetDescendants()) do
            if v.Name == "Rake" and v:FindFirstChild("HumanoidRootPart") then
                local dist = (v.HumanoidRootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                if dist < 20 then
                    LocalPlayer.Character:SetPrimaryPartCFrame(CFrame.new(Vector3.new(-250, 10, 200)))
                end
            end
        end
        wait(0.5)
    end
end

local function StopAntiRake()
    AntiRakeEnabled = false
end
